(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{339:function(a,e,s){"use strict";s.r(e);var t=s(12),r=Object(t.a)({},(function(){var a=this,e=a._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"selinux"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#selinux"}},[a._v("#")]),a._v(" SELinux")]),a._v(" "),e("hr"),a._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#toggle-selinux"}},[a._v("Toggle SELinux")])]),e("li",[e("a",{attrs:{href:"#audit2allow"}},[a._v("Audit2allow")])]),e("li",[e("a",{attrs:{href:"#setroubleshoot"}},[a._v("Setroubleshoot")]),e("ul",[e("li",[e("a",{attrs:{href:"#look-for-policy-denials"}},[a._v("Look for policy denials")])])])]),e("li",[e("a",{attrs:{href:"#compile-install-te"}},[a._v("Compile & Install TE")])]),e("li",[e("a",{attrs:{href:"#search-audit"}},[a._v("Search Audit")])]),e("li",[e("a",{attrs:{href:"#log-silent-denials"}},[a._v("Log Silent Denials")])])])]),e("p"),a._v(" "),e("h2",{attrs:{id:"toggle-selinux"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#toggle-selinux"}},[a._v("#")]),a._v(" Toggle SELinux")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("setenforce "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\nsetenforce "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])])]),e("h2",{attrs:{id:"audit2allow"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#audit2allow"}},[a._v("#")]),a._v(" Audit2allow")]),a._v(" "),e("p",[a._v("Check denials since last policy reload")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("audit2allow "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-law")]),a._v("\n")])])]),e("h2",{attrs:{id:"setroubleshoot"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setroubleshoot"}},[a._v("#")]),a._v(" Setroubleshoot")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v(" yum install -y setroubleshoot-server\n")])])]),e("h3",{attrs:{id:"look-for-policy-denials"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#look-for-policy-denials"}},[a._v("#")]),a._v(" Look for policy denials")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sealert -a /var/log/audit/audit.log\n")])])]),e("h2",{attrs:{id:"compile-install-te"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#compile-install-te"}},[a._v("#")]),a._v(" Compile & Install TE")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("checkmodule "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-M")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" rule.mod rule.te\nsemodule_package "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-o")]),a._v(" rule.pp "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" rule.mod\nsemodule "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" rule.pp\n")])])]),e("h2",{attrs:{id:"search-audit"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#search-audit"}},[a._v("#")]),a._v(" Search Audit")]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("ausearch "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" avc "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--start")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v(":15:00 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("27")]),a._v("/06/20\n")])])]),e("p",[a._v("Pipe output to audti2allow")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ausearch -m avc --start 15:15:00 27/06/20 | audit2allow -w\n")])])]),e("h2",{attrs:{id:"log-silent-denials"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-silent-denials"}},[a._v("#")]),a._v(" Log Silent Denials")]),a._v(" "),e("p",[e("a",{attrs:{href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security-enhanced_linux/sect-security-enhanced_linux-fixing_problems-possible_causes_of_silent_denials",target:"_blank",rel:"noopener noreferrer"}},[a._v("Reference"),e("OutboundLink")],1)]),a._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Log silent denials")]),a._v("\nsemodule "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-DB")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Don't log silent denials (default)")]),a._v("\nsemodule "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-B")]),a._v("\n")])])]),e("MediumZoom")],1)}),[],!1,null,null,null);e.default=r.exports}}]);