(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{324:function(e,t,s){"use strict";s.r(t);var a=s(12),r=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"file-system"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#file-system"}},[e._v("#")]),e._v(" File System")]),e._v(" "),t("p",[e._v("Some notes on working with the linux file system")]),e._v(" "),t("hr"),e._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#create-swap-file"}},[e._v("Create Swap File")])]),t("li",[t("a",{attrs:{href:"#detect-new-disk-size-without-reboot"}},[e._v("Detect new disk size without reboot")])]),t("li",[t("a",{attrs:{href:"#re-scan-scsi-bus-after-adding-new-disk"}},[e._v("Re-Scan SCSI Bus After Adding New Disk")])]),t("li",[t("a",{attrs:{href:"#full-disk-restore-checklist"}},[e._v("Full Disk Restore Checklist")]),t("ul",[t("li",[t("a",{attrs:{href:"#update-fstab"}},[e._v("Update fstab")])]),t("li",[t("a",{attrs:{href:"#generate-new-initrd"}},[e._v("Generate new initrd")])]),t("li",[t("a",{attrs:{href:"#update-grub-config"}},[e._v("Update grub config")])]),t("li",[t("a",{attrs:{href:"#update-network-settings"}},[e._v("Update network settings")])]),t("li",[t("a",{attrs:{href:"#install-grub"}},[e._v("Install grub")])])])])])]),t("p"),e._v(" "),t("h2",{attrs:{id:"create-swap-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-swap-file"}},[e._v("#")]),e._v(" Create Swap File")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("fallocate "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-l")]),e._v(" 4G /swap\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("600")]),e._v(" /swap\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkswap")]),e._v(" /swap\n"),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("swapon")]),e._v(" /swap\n")])])]),t("p",[t("code",[e._v("/etc/fstab")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("/swap swap swap defaults 0 0\n")])])]),t("h2",{attrs:{id:"detect-new-disk-size-without-reboot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#detect-new-disk-size-without-reboot"}},[e._v("#")]),e._v(" Detect new disk size without reboot")]),e._v(" "),t("p",[e._v("Tested on a VM:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/sys/class/scsi_device/"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Disk ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/device/rescan\n")])])]),t("p",[e._v("You can check in "),t("code",[e._v("/dev/disk/by-path/")]),e._v(" for the correct ID")]),e._v(" "),t("h2",{attrs:{id:"re-scan-scsi-bus-after-adding-new-disk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#re-scan-scsi-bus-after-adding-new-disk"}},[e._v("#")]),e._v(" Re-Scan SCSI Bus After Adding New Disk")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"- - -"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /sys/class/scsi_host/hostX/scan\n")])])]),t("h2",{attrs:{id:"full-disk-restore-checklist"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#full-disk-restore-checklist"}},[e._v("#")]),e._v(" Full Disk Restore Checklist")]),e._v(" "),t("p",[e._v("For when you're using a backup system that doesn't handle the boot configuration, grub, etc.")]),e._v(" "),t("h3",{attrs:{id:"update-fstab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#update-fstab"}},[e._v("#")]),e._v(" Update fstab")]),e._v(" "),t("p",[e._v("Grab the new UUID of the disks by running "),t("code",[e._v("blkid")]),t("br"),e._v("\nEdit "),t("code",[e._v("/etc/fstab")]),e._v(" and replace any "),t("code",[e._v("/dev/sdX")]),e._v(" or "),t("code",[e._v("UUID=")]),e._v(" entries with the new "),t("code",[e._v("UUID=xxxxxxx")])]),e._v(" "),t("h3",{attrs:{id:"generate-new-initrd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#generate-new-initrd"}},[e._v("#")]),e._v(" Generate new initrd")]),e._v(" "),t("p",[e._v("For Centos 6, run "),t("code",[e._v("dracut -f")]),t("br"),e._v("\nYou can also target a specific version of the kernel: "),t("code",[e._v("dracut -f </boot/filename.img> <kernel.version.x86_64>")]),t("br"),e._v("\nReference "),t("a",{attrs:{href:"https://www.thegeekdiary.com/centos-rhel-6-how-to-rebuild-initial-ramdisk-image/",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),t("OutboundLink")],1)]),e._v(" "),t("h3",{attrs:{id:"update-grub-config"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#update-grub-config"}},[e._v("#")]),e._v(" Update grub config")]),e._v(" "),t("p",[e._v("Different methods used depending on flavour of linux.\nFor Centos 6, you can just edit "),t("code",[e._v("/etc/grub.conf")]),t("br"),e._v("\nReplace any UUID references with your new ones")]),e._v(" "),t("h3",{attrs:{id:"update-network-settings"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#update-network-settings"}},[e._v("#")]),e._v(" Update network settings")]),e._v(" "),t("p",[e._v("Update the MAC for the network interfaces if this is a different machine.\nEdit the file at "),t("code",[e._v("/etc/udev/rules.d/70-persistent-net.rules")])]),e._v(" "),t("h3",{attrs:{id:"install-grub"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-grub"}},[e._v("#")]),e._v(" Install grub")]),e._v(" "),t("p",[e._v("For Centos 6, run "),t("code",[e._v("grub-install")])]),e._v(" "),t("MediumZoom")],1)}),[],!1,null,null,null);t.default=r.exports}}]);