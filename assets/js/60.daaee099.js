(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{359:function(e,a,s){"use strict";s.r(a);var t=s(12),r=Object(t.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"apache"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apache"}},[e._v("#")]),e._v(" Apache")]),e._v(" "),a("p",[e._v("Apache webserver stuff")]),e._v(" "),a("hr"),e._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#enable-htaccess"}},[e._v("Enable .htaccess")])]),a("li",[a("a",{attrs:{href:"#ssl-redirect"}},[e._v("SSL Redirect")])]),a("li",[a("a",{attrs:{href:"#password-access"}},[e._v("Password access")]),a("ul",[a("li",[a("a",{attrs:{href:"#apache-2-4"}},[e._v("Apache 2.4+")])]),a("li",[a("a",{attrs:{href:"#apache-2-2"}},[e._v("Apache 2.2")])])])]),a("li",[a("a",{attrs:{href:"#generate-htaccess-passwords"}},[e._v("Generate .htaccess Passwords")]),a("ul",[a("li",[a("a",{attrs:{href:"#creating-the-file-and-adding-the-first-user"}},[e._v("Creating the file and adding the first user")])]),a("li",[a("a",{attrs:{href:"#adding-additional-users"}},[e._v("Adding additional users")])])])]),a("li",[a("a",{attrs:{href:"#config-checks"}},[e._v("Config checks")])])])]),a("p"),e._v(" "),a("h2",{attrs:{id:"enable-htaccess"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enable-htaccess"}},[e._v("#")]),e._v(" Enable .htaccess")]),e._v(" "),a("p",[e._v("Overrides will need to be allowed inside the "),a("code",[e._v("<Directory>")]),e._v(" section of your "),a("code",[e._v(".conf")])]),e._v(" "),a("div",{staticClass:"language-apacheconf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("AllowOverride")]),e._v(" ALL\n")])])]),a("h2",{attrs:{id:"ssl-redirect"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssl-redirect"}},[e._v("#")]),e._v(" SSL Redirect")]),e._v(" "),a("p",[e._v("Instructions on how to redirect HTTP to HTTPS using .htaccess")]),e._v(" "),a("div",{staticClass:"language-apacheconf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("RewriteEngine")]),e._v(" On\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# This will enable the Rewrite capabilities")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("RewriteCond")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("%{HTTP:X-Forwarded-Proto}")]),e._v(" !https\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# We sit behind a load balancer on this service, so we need to check if https is being used by the end user")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("RewriteRule")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[e._v("^/?(.*) https://")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("%{SERVER_NAME}")]),e._v("/"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$1")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token directive-flags keyword"}},[e._v("[L,R=301]")]),e._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# This rule will redirect all users to the same location but using HTTPS.")]),e._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# R=301 sends a permanent redirect header to the client")]),e._v("\n")])])]),a("h2",{attrs:{id:"password-access"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#password-access"}},[e._v("#")]),e._v(" Password access")]),e._v(" "),a("h3",{attrs:{id:"apache-2-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apache-2-4"}},[e._v("#")]),e._v(" Apache 2.4+")]),e._v(" "),a("p",[e._v("This isn't supported under Apache 2.2.\nWe'll skip the password checks if they're not using HTTPS so that they can be redirected to HTTPS before being asked for a password.\n"),a("code",[e._v("192.168.0.1")]),e._v(" will not be prompted for a password.")]),e._v(" "),a("div",{staticClass:"language-apacheconf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("<")]),e._v("If")]),a("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("%{HTTPS}")]),e._v(" == 'on'\"")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("AuthType")]),e._v(" Basic\n\t"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("AuthName")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Password Protected Area"')]),e._v("\n\t"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("AuthUserFile")]),e._v(" /etc/.htpasswd\n\t"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Require")]),e._v(" valid-user\n\t"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Allow")]),e._v(" from env=!HTTPS\n\t"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Require")]),e._v(" ip 192.168.0.1\n"),a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token directive-block tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("</")]),e._v("If")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(">")])]),e._v("\n")])])]),a("h3",{attrs:{id:"apache-2-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apache-2-2"}},[e._v("#")]),e._v(" Apache 2.2")]),e._v(" "),a("div",{staticClass:"language-apacheconf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("AuthType")]),e._v(" Basic\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("AuthName")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Password Protected Area"')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("AuthUserFile")]),e._v(" /etc/.htpasswd\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Require")]),e._v(" valid-user\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Order")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("deny")]),e._v(",allow\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Deny")]),e._v(" from all\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Allow")]),e._v(" from 192.168.0.1\n"),a("span",{pre:!0,attrs:{class:"token directive-inline property"}},[e._v("Satisfy")]),e._v(" any\n")])])]),a("h2",{attrs:{id:"generate-htaccess-passwords"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#generate-htaccess-passwords"}},[e._v("#")]),e._v(" Generate .htaccess Passwords")]),e._v(" "),a("h3",{attrs:{id:"creating-the-file-and-adding-the-first-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-the-file-and-adding-the-first-user"}},[e._v("#")]),e._v(" Creating the file and adding the first user")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("htpasswd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-c")]),e._v(" /etc/.htpasswd "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("h3",{attrs:{id:"adding-additional-users"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adding-additional-users"}},[e._v("#")]),e._v(" Adding additional users")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("htpasswd /etc/.htpasswd "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),a("h2",{attrs:{id:"config-checks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#config-checks"}},[e._v("#")]),e._v(" Config checks")]),e._v(" "),a("p",[e._v("Show virtual servers and ports")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("apachectl -S\n")])])]),a("p",[e._v("Check configuration files are correct")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("apachectl configtest\n")])])]),a("p",[e._v("Reload config")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("apachectl graceful\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);