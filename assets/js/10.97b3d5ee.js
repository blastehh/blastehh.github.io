(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{284:function(t,a,s){t.exports=s.p+"assets/img/pfsense-ipsec-p1.fb16ba0d.png"},285:function(t,a,s){t.exports=s.p+"assets/img/pfsense-ipsec-p2.6731fa05.png"},348:function(t,a,s){"use strict";s.r(a);var e=s(12),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"clearos"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clearos"}},[t._v("#")]),t._v(" ClearOS")]),t._v(" "),a("p",[t._v("Notes on various things configured on "),a("a",{attrs:{href:"https://www.clearos.com/clearfoundation/software/clearos-7-community",target:"_blank",rel:"noopener noreferrer"}},[t._v("ClearOS"),a("OutboundLink")],1),t._v(" firewall.")]),t._v(" "),a("hr"),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#ipsec-tunnel-with-pfsense"}},[t._v("IPsec tunnel with PFsense")]),a("ul",[a("li",[a("a",{attrs:{href:"#clearos-config"}},[t._v("ClearOS Config")])]),a("li",[a("a",{attrs:{href:"#pfsense-config"}},[t._v("PFsense Config")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"ipsec-tunnel-with-pfsense"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ipsec-tunnel-with-pfsense"}},[t._v("#")]),t._v(" IPsec tunnel with PFsense")]),t._v(" "),a("p",[t._v("Public IPs have been replaced with "),a("code",[t._v("x.x.x.x")])]),t._v(" "),a("h3",{attrs:{id:"clearos-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clearos-config"}},[t._v("#")]),t._v(" ClearOS Config")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ipsec --version")]),t._v("\nLinux Libreswan "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.23")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("netkey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" on "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.10")]),t._v(".0-693.17.1.v7.x86_64\n")])])]),a("p",[a("code",[t._v("cat /etc/ipsec.d/ipsec.unmanaged.mytunnel.conf")])]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("conn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("mytunnel")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" keyexchange")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("ike")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" fragmentation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("yes")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" rekey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("yes")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("tunnel")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" dpdaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("restart")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" dpdtimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("60s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" dpddelay")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("10s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" auto")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("start")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" left")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("x.x.x.x")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" leftsubnet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("192.168.50.0/24")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" right")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("mytunnel.blasteh.uk")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" rightid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("@mytunnel.blasteh.uk")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" rightsubnet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("192.168.10.0/24")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" ikelifetime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("28800s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" lifetime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("3600s")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" ikev2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("insist")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" ike")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("aes256-sha2;dh14")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" esp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("aes256-sha2;dh14")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" leftauth")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("secret")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v(" rightauth")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("secret")]),t._v("\n")])])]),a("p",[a("code",[t._v("left")]),t._v(" defines the ClearOS firewall's public IP")]),t._v(" "),a("p",[a("code",[t._v("leftsubnet")]),t._v(" is the subnet that will be passed through the tunnel")]),t._v(" "),a("p",[a("code",[t._v("right")]),t._v(" is my pfsense box on the other side of the tunnel")]),t._v(" "),a("p",[a("code",[t._v("rightsubnet")]),t._v(" is the remote subnet that will be accessible through this tunnel.")]),t._v(" "),a("p",[a("code",[t._v("cat /etc/ipsec.d/ipsec.unmanaged.mytunnel.secrets")])]),t._v(" "),a("div",{staticClass:"language-properties extra-class"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("x.x.x.x")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v('@mytunnel.blasteh.uk : PSK "mysecretkey"')]),t._v("\n")])])]),a("h3",{attrs:{id:"pfsense-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pfsense-config"}},[t._v("#")]),t._v(" PFsense Config")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("2.4.4-RELEASE-p1 (amd64) \nbuilt on Mon Nov 26 11:40:26 EST 2018 \nFreeBSD 11.2-RELEASE-p4 \n")])])]),a("h4",{attrs:{id:"phase-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#phase-1"}},[t._v("#")]),t._v(" Phase 1")]),t._v(" "),a("p",[a("img",{attrs:{src:s(284),alt:""}})]),t._v(" "),a("h4",{attrs:{id:"phase-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#phase-2"}},[t._v("#")]),t._v(" Phase 2")]),t._v(" "),a("p",[a("img",{attrs:{src:s(285),alt:""}})]),t._v(" "),a("MediumZoom")],1)}),[],!1,null,null,null);a.default=n.exports}}]);